<div xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org"
     layout:decorate="~{shared/_layout}" layout:fragment="content">
    <h1 class="alert alert-danger" th:text="${param.message[0]}">error</h1>
    <br/>
    <a class="btn btn-default" th:href="@{/registration.html}" th:text="#{label.form.loginSignUp}">signup</a>

    <div th:if="${param.expired[0]}">
        <br/>
        <h1 th:text="#{label.form.resendRegistrationToken}">resend</h1>
        <button onclick="resendToken()">resend</button>

        <script th:inline="javascript">
            var serverContext = [[@{/}]];

                function resendToken() {
                    var token = [[${param.token}]];
                    $.get(serverContext + "/account/resendRegistrationToken?token=" + token, function (data) {
                        window.location.href = serverContext + "/account/login?message=" + data.message;
                    })
                        .fail(function (data) {
                            if (data.responseJSON.error.indexOf("MailError") > -1) {
                                window.location.href = serverContext + "/account/emailError.html";
                            } else {
                                window.location.href = serverContext + "/account/login?message=" + data.responseJSON.message;
                            }
                        });
                }

                $(document).ajaxStart(function () {
                    $("title").html("LOADING ...");
                });
        </script>
    </div>
</div>